# Manual Chrome Hybrid Mode Configuration
# =========================================
# This configuration file controls the manual Chrome fallback mechanism.
#
# The manual Chrome mode is triggered when all automated fetching methods fail.
# It allows a human to navigate the browser manually, then automatically extracts
# the content via Chrome DevTools Protocol (CDP).

# Enable/disable manual Chrome fallback
enabled: true

# Platform specification (macOS only in this implementation)
platform: macos

# Chrome browser settings
chrome:
  # Chrome executable path (optional)
  # If not specified, uses default macOS path:
  # /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
  #
  # Uncomment and set if Chrome is in a non-standard location:
  # path: "/Applications/Google Chrome Canary.app/Contents/MacOS/Google Chrome Canary"

  # Remote debugging port
  # Default: 9222 (Chrome's default debug port)
  # Change if port conflicts with other services
  debug_port: 9222

  # User data directory for Chrome session
  # This is a temporary profile directory used only for manual fetch sessions
  # Default: /tmp/web-fetcher-manual
  user_data_dir: "/tmp/web-fetcher-manual"

# User experience settings
ux:
  # Automatically copy URL to clipboard when manual mode is triggered
  # Requires: pip install pyperclip
  # If pyperclip is not available, falls back gracefully with a warning
  auto_copy_url: true

  # Show system notification when manual mode is triggered
  # Currently not implemented, reserved for future use
  show_notification: false

  # Maximum wait time for user to complete navigation (seconds)
  # After this timeout, the session will be cancelled
  # Default: 300 (5 minutes)
  wait_timeout: 300

# Fallback trigger conditions
# Manual Chrome mode will be triggered when:
trigger:
  # All automated retries have been exhausted
  after_all_retries: true

  # HTTP status codes that indicate anti-bot protection
  # These status codes suggest automated detection
  suspicious_status_codes:
    - 400  # Bad Request (often anti-bot)
    - 403  # Forbidden (often anti-bot)
    - 412  # Precondition Failed (often anti-bot)
    - 429  # Too Many Requests (rate limiting)

  # Minimum response size threshold (bytes)
  # Responses smaller than this are considered suspicious (empty HTML)
  min_response_size: 100

  # Keywords in error messages that suggest manual intervention needed
  error_keywords:
    - "隐私设置错误"  # Privacy Settings Error
    - "访问被拒绝"    # Access Denied
    - "验证码"        # CAPTCHA
    - "人机验证"      # Human Verification

# Logging
logging:
  # Log level for manual Chrome operations
  # Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
  level: INFO

  # Include detailed debug information
  debug: false

# Advanced options
advanced:
  # Additional Chrome launch flags (optional)
  # These flags will be passed to Chrome when starting
  extra_chrome_flags:
    - "--no-first-run"
    - "--no-default-browser-check"
    # Uncomment if you need to disable certificate errors:
    # - "--ignore-certificate-errors"

  # Automatically close Chrome after successful extraction
  # If false, Chrome window stays open for debugging
  auto_close_chrome: false

  # Maximum number of attachment retry attempts
  max_attachment_retries: 3

  # Delay between attachment retries (seconds)
  attachment_retry_delay: 2
